{"paragraphs":[{"text":"%sh\r\npip install hdfs","user":"anonymous","dateUpdated":"2025-04-16T05:56:03+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requirement already satisfied: hdfs in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (2.7.3)\nRequirement already satisfied: docopt in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from hdfs) (0.6.2)\nRequirement already satisfied: requests>=2.7.0 in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from hdfs) (2.32.3)\nRequirement already satisfied: six>=1.9.0 in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from hdfs) (1.17.0)\nRequirement already satisfied: charset_normalizer<4,>=2 in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from requests>=2.7.0->hdfs) (3.4.1)\nRequirement already satisfied: idna<4,>=2.5 in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from requests>=2.7.0->hdfs) (3.10)\nRequirement already satisfied: urllib3<3,>=1.21.1 in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from requests>=2.7.0->hdfs) (2.3.0)\nRequirement already satisfied: certifi>=2017.4.17 in /opt/conda/envs/python_3_with_R/lib/python3.9/site-packages (from requests>=2.7.0->hdfs) (2024.12.14)\nWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\n"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744782958286_1426182931","id":"paragraph_1744782958286_1426182931","dateCreated":"2025-04-16T05:55:58+0000","dateStarted":"2025-04-16T05:56:03+0000","dateFinished":"2025-04-16T05:56:04+0000","status":"FINISHED","focus":false},{"text":"from hdfs import InsecureClient\nuser = \"hadoop\"\nhost = \"http://namenode:9870\"\npath = \"/user/hadoop/LICENSE.txt\"\nhdfs = InsecureClient(host,user=user)\nwith hdfs.read(path, encoding=\"utf-8\") as reader :\n    text = reader.read()\nprint(text[:100])\n\n\n","user":"anonymous","dateUpdated":"2025-04-16T06:07:52+0000","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744782963812_907453241","id":"paragraph_1744782963812_907453241","dateCreated":"2025-04-16T05:56:03+0000","status":"FINISHED","focus":false,"dateFinished":"2025-04-16T06:07:52+0000","dateStarted":"2025-04-16T06:07:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n                                 Apache License\n                           Version 2.0, January 200\n"}]}},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744782971849_908160839","id":"paragraph_1744782971849_908160839","dateCreated":"2025-04-16T05:56:11+0000","status":"FINISHED","text":"from collections import Counter\r\n\r\nwords = text.strip().split()\r\nword_counts = Counter(words)\r\n#print(word_counts)\r\n#for word, count in word_counts.items():\r\n #   print(word,\" \", count)","dateUpdated":"2025-04-16T06:08:10+0000","dateFinished":"2025-04-16T06:08:10+0000","dateStarted":"2025-04-16T06:08:10+0000","results":{"code":"SUCCESS","msg":[]},"focus":false},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744783578631_762985277","id":"paragraph_1744783578631_762985277","dateCreated":"2025-04-16T06:06:18+0000","status":"FINISHED","text":"hdfs_dir=\"/user/hadoop\"\r\nshow=hdfs.list(hdfs_dir)\r\nfor s in show:\r\n    print(s)","dateUpdated":"2025-04-16T06:08:15+0000","dateFinished":"2025-04-16T06:08:16+0000","dateStarted":"2025-04-16T06:08:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"월.분기.연간_인구동향_출생_2025.csv\nLICENSE.txt\ndocker001.png\ngrep-output\npy09.ipynb\npy13_셀레니움크롤링3.ipynb\nstarbuck_20250411135356.csv\nstarbucks.csv\nwordcount-output\n"}]},"focus":false},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744783606329_1771353767","id":"paragraph_1744783606329_1771353767","dateCreated":"2025-04-16T06:06:46+0000","status":"ERROR","text":"# 파일 업로드\r\nlocal_path='../data/ref/starbuck_20250411135356.csv'\r\nhdfs_path='/user/hadoop/starbucks.csv'\r\nhdfs.upload(hdfs_path, local_path, overwrite = True )\r\nprint(\"업로드 완료\")\r\n","focus":false,"dateUpdated":"2025-04-16T06:09:02+0000","dateFinished":"2025-04-16T06:09:02+0000","dateStarted":"2025-04-16T06:09:02+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mHdfsError\u001b[0m                                 Traceback (most recent call last)\nCell \u001b[0;32mIn[18], line 4\u001b[0m\n\u001b[1;32m      2\u001b[0m local_path\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m../data/ref/starbuck_20250411135356.csv\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[1;32m      3\u001b[0m hdfs_path\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124m/user/hadoop/starbucks.csv\u001b[39m\u001b[38;5;124m'\u001b[39m\n\u001b[0;32m----> 4\u001b[0m \u001b[43mhdfs\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mupload\u001b[49m\u001b[43m(\u001b[49m\u001b[43mhdfs_path\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mlocal_path\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43moverwrite\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m      5\u001b[0m \u001b[38;5;28mprint\u001b[39m(\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124m업로드 완료\u001b[39m\u001b[38;5;124m\"\u001b[39m)\n\nFile \u001b[0;32m/opt/conda/envs/python_3_with_R/lib/python3.9/site-packages/hdfs/client.py:631\u001b[0m, in \u001b[0;36mClient.upload\u001b[0;34m(self, hdfs_path, local_path, n_threads, temp_dir, chunk_size, progress, cleanup, **kwargs)\u001b[0m\n\u001b[1;32m    629\u001b[0m   fpath_tuples \u001b[38;5;241m=\u001b[39m [(local_path, temp_path)]\n\u001b[1;32m    630\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 631\u001b[0m   \u001b[38;5;28;01mraise\u001b[39;00m HdfsError(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mLocal path \u001b[39m\u001b[38;5;132;01m%r\u001b[39;00m\u001b[38;5;124m does not exist.\u001b[39m\u001b[38;5;124m'\u001b[39m, local_path)\n\u001b[1;32m    632\u001b[0m \u001b[38;5;66;03m# Finally, we upload all files (optionally, in parallel).\u001b[39;00m\n\u001b[1;32m    633\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m n_threads \u001b[38;5;241m<\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m0\u001b[39m:\n\n\u001b[0;31mHdfsError\u001b[0m: Local path '../data/ref/starbuck_20250411135356.csv' does not exist."}]}},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744783617887_253719459","id":"paragraph_1744783617887_253719459","dateCreated":"2025-04-16T06:06:57+0000","status":"FINISHED","text":"# 파일 확인\r\nhdfs_path='/user/hadoop/'\r\nfile_name ='starbucks.csv'\r\ncheck =hdfs_path+file_name\r\nif hdfs.status(check, strict=False) ==None:\r\n    print(f\"{hdfs_path}의 파일이 없습니다\")\r\nelse:\r\n    print(hdfs.status(hdfs_path, strict=False))","dateUpdated":"2025-04-16T06:08:46+0000","dateFinished":"2025-04-16T06:08:46+0000","dateStarted":"2025-04-16T06:08:46+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{'accessTime': 0, 'blockSize': 0, 'childrenNum': 9, 'fileId': 16387, 'group': 'supergroup', 'length': 0, 'modificationTime': 1744780896254, 'owner': 'hadoop', 'pathSuffix': '', 'permission': '777', 'replication': 0, 'storagePolicy': 0, 'type': 'DIRECTORY'}\n"}]},"focus":false},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744783726782_1908486668","id":"paragraph_1744783726782_1908486668","dateCreated":"2025-04-16T06:08:46+0000","status":"FINISHED","text":"hdfs_path = '/user/hadoop/'\r\ndel_file = 'starbucks.csv2'\r\nfull_path = hdfs_path +del_file\r\nif hdfs.delete(hdfs_path + del_file):\r\n    print(\"삭제되었습니다\")\r\nelse:\r\n    if hdfs.status(full_path, strict=False)==None:\r\n        print(f\"{hdfs_path}의 파일이 없습니다.\")","focus":false,"dateUpdated":"2025-04-16T06:08:54+0000","dateFinished":"2025-04-16T06:08:54+0000","dateStarted":"2025-04-16T06:08:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"/user/hadoop/의 파일이 없습니다.\n"}]}},{"user":"anonymous","progress":0,"config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{}},"settings":{"params":{},"forms":{}},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1744783734322_1514265882","id":"paragraph_1744783734322_1514265882","dateCreated":"2025-04-16T06:08:54+0000","status":"READY","text":"","dateUpdated":"2025-04-16T06:09:13+0000","results":{}}],"name":"Untitled Note 2","id":"2KTUA8W9H","defaultInterpreterGroup":"python","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/Untitled Note 2"}